<!doctype html>
<html>
	<head>

		<title></title>

		<script src="../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
		<script>
			window.Polymer = window.Polymer || {};
			window.Polymer.dom = 'shadow';
		</script>
		<link rel="import" href="../../polymer/polymer.html">
		<link rel="import" href="../../paper-card/paper-card.html">
		<link rel="import" href="../paper-datatable-card.html">
		<link rel="import" href="../paper-datatable.html">

		<style is="custom-style">

			:root{
				--paper-datatable-array-item: {
					min-width: 15px;
					height: 17px;
					text-align: center;
					border-radius: 8px;
					background: gray;
					color: white;
					padding: 0px 1px;
				};
			}

			paper-card{
				padding:20px;
				margin:20px;
				display:block;
			}

		</style>

	</head>
	<body>

		<template is="dom-bind" id="app">
			<paper-card>
				<paper-datatable data="{{data}}" id-property="aid" selectable>
					<paper-datatable-column header="ID" property="aid" type="String" tooltip="Some title" sortable>	</paper-datatable-column>
					<paper-datatable-column header="Dessert (100g serving)" property="title" type="String" tooltip="Some title" sortable>	</paper-datatable-column>
					<paper-datatable-column header="Calories" property="calories" type="Number" tooltip="The total amount of..." sortable>
						<template>
							<paper-input value="{{value}}" no-label-float></paper-input>
						</template>
					</paper-datatable-column>
				</paper-datatable>
			</paper-card>
			<paper-card>
				<paper-datatable data="{{data}}" id-property="aid" selectable multi-selection>
					<paper-datatable-column header="Dessert (100g serving)" property="title" type="String" tooltip="Some title" sortable>	</paper-datatable-column>
					<paper-datatable-column header="Calories" property="calories" type="Number" tooltip="The total amount of..." sortable>
						<template>
							<paper-input value="{{value}}"></paper-input>
							<paper-input value="{{item.calories}}"></paper-input>
							<paper-input value="{{item.complexObj.a}}"></paper-input>
						</template>
					</paper-datatable-column>
					<paper-datatable-column header="Object" property="complexObj" type="Object" tooltip="The total amount of..." sortable>
						<template>
							<paper-input value="{{value.a}}"></paper-input>
							<paper-input value="{{item.complexObj.a}}"></paper-input>
							<paper-input value="{{item.complexObj.b}}"></paper-input>
						</template>
					</paper-datatable-column>
					<paper-datatable-column header="Array" property="arr" type="Array" tooltip="The total amount of..." sortable>
						<template>
							<template is="dom-repeat" items="{{value}}" as="valueItem">
								<paper-input value="{{valueItem}}"></paper-input>
							</template>
						</template>
					</paper-datatable-column>
				</paper-datatable>
			</paper-card>

			<paper-card>
				<paper-datatable data="{{data}}" id-property="aid" selectable multi-selection>
					<paper-datatable-column header="Dessert (100g serving)" property="title" type="String" sortable editable></paper-datatable-column>
					<paper-datatable-column header="Yummy" property="yummy" type="Boolean" sortable editable align="center"></paper-datatable-column>
					<paper-datatable-column header="Calories" property="calories" type="Number" sortable editable></paper-datatable-column>
					<paper-datatable-column header="Array" property="arr" type="Array"></paper-datatable-column>
					<paper-datatable-column header="Created" property="created" type="Date" sortable cell-style="color:gray;"></paper-datatable-column>
				</paper-datatable>
			</paper-card>

			Calories: <span>{{getItem(data.*, 'data.0.calories')}}</span>
			Array item: <span>{{getItem(data.*, 'data.0.arr.0')}}</span>

			<paper-card>
				<paper-datatable id="table_with_links" data="{{data}}" id-property="aid" selectable multi-selection>
					<paper-datatable-column header="Dessert (100g serving)" property="title" type="String" sortable editable></paper-datatable-column>
					<paper-datatable-column header="Yummy" property="yummy" type="Boolean" sortable editable align="center"></paper-datatable-column>
					<paper-datatable-column header="Calories" property="calories" type="Number" sortable editable></paper-datatable-column>
					<paper-datatable-column header="Check out" property="weblinktext" type="Link" sortable></paper-datatable-column>
				</paper-datatable>
			</paper-card>
			Check out: <span>{{urldescription}}</span> <a href="{{urlhref}}">{{urltitle}}</a>
		</template>

		<script>
			var app = document.querySelector('#app');
			//this function is necessary, because since Polymer 1.2 paths with indexes aren't allowed in direct bindings
			app.getItem = function(watcher, path){
				return this.get(path);
			};
			app.data = [
				{aid: 'asdf', title: 'Ice cream', yummy: true, calories: 2000, complexObj: {a: 'b', b: 'd'}, arr: [2,3,4], created: new Date(), weblink: 'https://www.google.com/search?tbm=isch&q=ice+cream', weblinktext: 'Google Picture Search'},
				{aid: 'sdfg', title: 'Dessert', yummy: true, calories: 3000, complexObj: {a: 'bb', b: 'dd'}, arr: [5,6], created: new Date(), weblink: 'https://www.google.com/search?tbm=isch&q=dessert', weblinktext: 'Google Picture Search'},
				{aid: 'sdas', title: 'Cake', yummy: false, calories: 4000, complexObj: {a: 'cc', b: 'gg'}, arr: [7,8], created: new Date(), weblink: 'https://www.google.com/search?tbm=isch&q=cake', weblinktext: 'Google Picture Search'}
			];
			
			// The dom-change event signifies when the template has stamped its DOM.
			app.addEventListener('dom-change', function() {
				console.log('auto-binding template is ready.');
				var that = this;
				this.$.table_with_links.addEventListener('link-clicked', function(e){
					console.log(this); // we're in the context of the paper-datatable
					var rowId = e.detail.cell.getAttribute('data-row-id');
					var row = this.getDataRow(rowId);
					that.urldescription = e.detail.originalEvent.target.innerText;
					that.urltitle = row.title;
					that.urlhref = row.weblink;
				});
			});
		</script>

	</body>
</html>
